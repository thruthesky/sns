# 로컬 기반 소셜 모임 서비스

본 문서는 로컬 기반 소셜 모임 기능의 기획 및 개발 지침을 제공합니다.

---

## 📋 목차

1. [서비스 개요](#서비스-개요)
2. [핵심 가치](#핵심-가치)
3. [주요 기능](#주요-기능)
4. [기술 스택](#기술-스택)
5. [개발 원칙](#개발-원칙)
6. [사용자 플로우](#사용자-플로우)
7. [실시간 기능 구현](#실시간-기능-구현)

---

## 서비스 개요

### 목적

소셜 서비스에서 **친구 관계를 바탕으로 하는 로컬 모임** 기능을 제공하는 웹/앱 개발

### 컨셉

도시/지역(예: 서울·마닐라·도쿄) 단위로 자연스럽게 연결되는 **"로컬 소셜 네트워크"**

- 같은 지역의 사용자들과 자연스럽게 채팅(대화)
- 개인적인 취미/로그 기록을 전 세계 사람들과 공유
- 동일 지역의 사용자 목록이 자동 노출
- 1:1/그룹 채팅과 피드를 통해 로컬에서 글로벌로 확장되는 커뮤니티

### 기본 흐름

1. **로그인 전**: 서비스의 기본 정보만 확인 가능
2. **Firebase Auth 로그인**: 실제 서비스 이용 시작
3. **지역 자동 감지**: 내가 속한 지역(서울, 마닐라, 도쿄 등) 표시
4. **사용자 목록 자동 표시**: 같은 지역에 가입된 사용자 목록 노출
5. **채팅 시작**: 채팅창으로 실제 대화 진행

---

## 핵심 가치

### 🌍 지역 기반 매칭

- 자동 위치 분류 및 도시 식별
- 근접성·언어·취향 필터링
- 수동 지역 변경 허용

### ⚡ 실시간 대화와 존재감

- **페이지 리프레시 없이** 100% 실시간 업데이트
- 온라인/오프라인 상태 실시간 표시
- 타이핑 중, 읽음 상태 표시
- 최근 활동 시간 표시

### 📝 가벼운 기록의 축적

- 개인 취미/로그 기록
- 지역 피드 공유
- 전 세계 탐색 가능

---

## 주요 기능

### 1️⃣ 위치 기반 온보딩

- 위치 권한 요청
- 자동 도시 식별
- 지역 선택 (자동 제안 + 수동 변경)

### 2️⃣ 실시간 사용자 목록

- 동일 지역 사용자 목록 (그리드/리스트 뷰)
- 온라인/오프라인/최근 활동 상태 표시
- **100% 실시간 업데이트가 기본 원칙**

### 3️⃣ 채팅 기능

- **1:1 채팅** 및 **소규모 그룹 채팅**
- 읽음 표시, 타이핑 중 표시
- 이미지·이모지·링크 미리보기
- 미디어 전송 (사진, 동영상 등)

### 4️⃣ 푸시 알림

- 새 메시지 알림
- 멘션 알림
- 팔로우 알림
- 좋아요 알림
- 실시간 푸시 + 앱 내 알림함

### 5️⃣ 프로필

- 닉네임, 자기소개
- 관심사 태그
- 연락 선호도 설정

### 6️⃣ 좋아요 & 팔로우

- 좋아요 기능
- 팔로우/언팔로우
- 개인 피드 및 지역 피드
- 텍스트/이미지 게시물
- 기본 신고·차단 기능

### 7️⃣ 검색

- 사용자 검색
- 해시태그 검색
- 지역 피드 검색

### 8️⃣ 추가 기능

- 다국어 자동 번역 (토글 방식, 로컬 언어 우선 표시)
- 오프라인 캐시
- 스토리/릴스형 숏폼 콘텐츠

---

## 기술 스택

### 🌐 웹 개발

**플랫폼**: Svelte 5 (버전: `svelte@5.43.2`)

- **개발 방식**: Svelte + Vite 라이브러리 모드
- **빌드 설정**: `customElement: true` 방식으로 Web Components 생성
- **CSS**: Tailwind CSS
- **목적**: www.philgo.com 및 www.sonub.com 등 다양한 Philgo 플랫폼에서 **동일한 컴포넌트 공유 및 재사용**

### 📱 모바일 앱 개발

**플랫폼**: Flutter

- iOS 및 Android 크로스 플랫폼 개발
- 웹과 동일한 Firebase 백엔드 활용

### ☁️ 백엔드

**플랫폼**: Firebase

- **Firebase Auth**: 사용자 인증 및 로그인 관리
- **Firebase Realtime Database (RTDB)**: 실시간 데이터 동기화 및 저장
- **Firebase Cloud Functions**: 서버리스 백엔드 로직 처리 (필요 시)

---

## 개발 원칙

### ✅ 반드시 지켜야 할 원칙

1. **모든 정보는 실시간 업데이트가 원칙**
   - 페이지 리프레시 없이 모든 데이터 실시간 반영

2. **온라인/오프라인 상태 구현**
   - Firebase RTDB의 `.info/connected` 활용
   - 사용자 접속/이탈 시 즉시 반영

3. **Web Components 표준 준수**
   - 재사용 가능한 Custom Elements 개발
   - 플랫폼 간 컴포넌트 공유

4. **Firebase 중심 아키텍처**
   - 별도 백엔드 서버 없이 Firebase만 활용
   - 클라이언트-서버 아키텍처 최소화

---

## 사용자 플로우

### 1. 첫 접속

```
위치 권한 요청 → 반경/도시 매핑 → 지역 선택 (자동 제안 + 수동 전환)
```

### 2. 홈 화면

- **"내 지역" 실시간 사용자 목록** (그리드/리스트)
- **지역 피드 탭**

### 3. 채팅

- 1:1·그룹 채팅
- 온라인/오프라인 상태 표시
- 읽음/타이핑 중 표시
- 미디어 전송

### 4. 프로필 & 관심사

- 태그 기반 팔로우 추천
- 관심사 기반 사용자 매칭

### 5. 알림

- 실시간 푸시 알림
- 앱 내 알림함

### 6. 권한 & 안전

- 신고·차단 기능
- 연령 기준 설정
- 위치 공개 범위 (도시/구·비공개)

### 7. 다국어

- 자동 번역 토글
- 로컬 언어 우선 표시

---

## 실시간 기능 구현

### Firebase RTDB `.info/connected` 활용

```javascript
// 온라인 상태 감지 예시
const connectedRef = firebase.database().ref('.info/connected');
connectedRef.on('value', (snapshot) => {
  if (snapshot.val() === true) {
    // 온라인 상태
    userStatusRef.set('online');

    // 연결 끊김 시 오프라인으로 변경
    userStatusRef.onDisconnect().set('offline');
  }
});
```

### 실시간 데이터 동기화

- **사용자 목록**: RTDB에서 실시간으로 구독
- **채팅 메시지**: RTDB child_added/child_changed 이벤트 리스닝
- **온라인 상태**: presence 시스템 구현
- **타이핑 중 표시**: 임시 상태 데이터 실시간 업데이트

---

## 참고 사항

- 본 문서는 **기획 단계**의 문서이며, 개발 진행에 따라 업데이트됩니다.
- 세부 기술 스펙 및 API 설계는 별도 문서로 관리합니다.


